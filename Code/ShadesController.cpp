
#include "ShadesController.h"

#define _ 0

u8 Frames[][ShadesController::Height][ShadesController::Width] = 
{
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,1,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,1,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,1,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,1,1,1,1,1,1,_,_},
		{_,_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_} },
		
	{	{_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,1,_,1,_,1,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,_,1,_,1,_,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_}	},
		
	{	{_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,1,_,1,_,1,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,_,1,_,1,_,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,1,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,1,_,_,_},
		{_,_,_,_,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,1,_,_,_,_}	},
	
	{	{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_}	},
	
	{	{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_},
		{_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_},
		{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_}	},
	
	{	{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_}	},
	
	{	{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_},
		{_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_,_},
		{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_}	},
	
	{	{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_}	},
		
	{	{_,_,1,1,1,_,_,_,_,1,_,_,_,_,_,1,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,_,1,_,_,1,_,1,_,_,_,1,_,1,_,_,1,_,_,1,_,_},
		{_,_,1,1,1,_,_,_,1,_,1,_,_,_,1,_,1,_,_,1,1,1,_,_,_},
		{_,_,1,_,_,1,_,_,_,1,_,_,_,_,_,1,_,_,_,1,_,_,_,_,_},
		{_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_}	},
		
	{	{_,_,1,1,1,_,_,_,_,1,_,_,_,_,_,1,_,_,_,1,1,1,_,_,_},
		{_,_,1,_,_,1,_,_,1,_,1,_,_,_,1,_,1,_,_,1,_,_,1,_,_},
		{_,_,1,1,1,_,_,_,1,_,1,_,_,_,1,_,1,_,_,1,1,1,_,_,_},
		{_,_,1,_,_,1,_,_,_,1,_,_,_,_,_,1,_,_,_,1,_,_,_,_,_},
		{_,_,1,1,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_,_}	},
	
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,_,_},
		{_,_,1,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
	
	{	{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,_,_},
		{_,_,1,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
	
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,_,_},
		{_,_,1,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
	
	{	{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,_,_},
		{_,_,1,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
	
	{	{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_},
		{_,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,_},
		{_,_,_,1,_,1,_,_,_,_,_,_,_,_,_,_,_,_,_,1,_,1,_,_,_},
		{_,_,1,_,_,_,1,_,_,_,_,_,_,_,_,_,_,_,1,_,_,_,1,_,_},
		{_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_}	},
};

#undef _

ShadesController::ShadesController()
{
	for (int i = 0; i < Width*Height; i++)
	{
		((RGB *)Lights)[i] = HSL((double)i/(Width*Height))();
	}
}

void ShadesController::CopyFrame(u8 src[Height][Width])
{
	for (int i = 0; i < Width*Height; i++)
	{
		((RGB *)Lights)[i] = ( ((u8 *)src)[i] ? RGB{255,255,255} : ((RGB *)Lights)[i] );
	}
}

void ShadesController::CopyFrame(RGB src[Height][Width])
{
	for (int i = 0; i < Width*Height; i++)
	{
		((RGB *)Lights)[i] = ((RGB *)src)[i];
	}
}

void ShadesController::Update(i64 now)
{
	for (int y = 0; y < Height; y++)
	{
		for (int x = 0; x < Width; x++)
		{
			Lights[y][x] = HSL(mmod((now%2000)/2000.0 + (-y-x)/50.0,1.0),1.0,0.3)();
		}
	}
	CopyFrame(Frames[0+1*now/200 % 27]);
}

#ifdef GRAPHICAL
void ShadesController::Draw(int xOff, int yOff)
{
	for (int y = 0; y < Height; y++)
	{
		for (int x = 0; x < Width; x++)
		{
			if (!(x==0 && y==0) && !(x==Width-1 && y==0) && !(x==0 && y==Height-1) && !(x==Width-1 && y==Height-1) && !(x>Width/2-4 && x<Width/2+4 && y==Height-1) && !(x>Width/2-3 && x<Width/2+3 && y==Height-2))
			{
				DrawRectangle(x*30+xOff, y*30+yOff, 20, 20, Lights[y][x]);
			}
		}
	}
	OutlineRectangle(xOff-2, yOff-2, Width*30-10+2+2, Height*30-10+2+2, {255,255,255});
}
#endif

